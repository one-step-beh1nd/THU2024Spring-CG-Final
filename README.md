# THU 2024 春 计算机图形学基础大作业
## 说在前面

本仓库的价值**不在代码，而在该README文件**

该仓库是贵系的一个菜鸡在被图形学折磨了一个星期后有感而发。

如果您是贵系大佬，请您移步其他仓库，因为本仓库可能并不能满足您的胃口。你并不能从该仓库中获得许多功能点的实现，甚至其中有的功能点至今仍有问题。

那我为什么要建立这个仓库呢？

图形学大作业之难度，讲解之匮乏，ppt之混乱，是我前所未见的。

本学期我有两个大作业：软工和图形学。这两个大作业都有着`讲解缺乏、上手困难`的问题。

软工给人的感觉是虽上手难，但熟练之后工作效率提高很多，“条条大路通罗马”，而且对查重要求很低；图形学给人的感觉是很难，而且路径十分有限，自己硬想一天不如别人点醒一句。

再加上课程ppt中对于参数定义十分繁杂且混乱，有时候看公式根本不知道对应什么东西，甚至能出现 `变量 + 常量`的公式（说的就是cook torrance）。

所以被折磨后，我希望能借此文件帮助同学`快速上手图形学作业`。我将在该文件中，`讲解我实现的功能点的实现路径`，防止出现看着学长的代码都不知道怎么抄的情况。

在这里远程感谢以下代码对我写大作业的帮助：

[学长的代码](https://github.com/zhanglbthu/THU2023Spring-CG-FinalProject) 实现了

- whitted style光线追踪（疑似有bug）
- path tracing，不包括NEE、glossy材质
- 参数曲面求交（有明显的bug，可能他报告里的图不是他生成的）
- **OPENMP加速（不作为得分点，但可以大大减少渲染时间，从而更快出结果）**
- 光子映射（自2024春开始不再得分，因为太多人抄往年的这个算法）
- 纹理贴图
- 景深相机
- cos-weighted采样
- 抗锯齿（然而抗的效果并不好）
- 复杂三角网格（我没写，不敢保证他的一定对）
- 包围盒（同上）
- BVH树（同上）
- 法向插值（同上）


[smallpt](https://blog.csdn.net/g11d111/article/details/108189198) 请不要看99行的，去看二百多行的。其中包含

- path tracing，包括NEE，不包括glossy材质
- 抗锯齿（效果很好，但是时间耗费更多，约4倍）
- OPENMP加速
- cos-weighted采样

[基于cook-torrance模型实现glossy材质](https://zhuanlan.zhihu.com/p/160804623)
- 如题，其效果确实好，但有需要注意的地方，见后 TODO:加入超链接

## 一、 效果图



## 一. 大作业要求
以下为课程发布的大作业要求
```
下面是光线追踪大作业（共45分）不同效果给分的权重。

- 基础项：推荐先实现Whitted-Style光线追踪，再实现路径追踪，前者的代码实现应真包含于后者。

（1）Whitted-Style光线追踪：
  - 材质：折射
  - 材质：反射
  - Shadow Ray：阴影

（2）路径追踪：
  - 支持面光源；无穷递归，终止策略使用Russian Routelette
  - 基于BRDF的着色（使用蒙特卡洛积分计算着色），支持漫反射、理想折射、理想反射、glossy（光滑面）材质
  - NEE（Next Event Estimation）

- 高

  - 参数曲面解析法求交
  - 复杂网格模型及其求交加速（包围盒和层次结构）
  - 更复杂的光线追踪方案：双向光线跟踪算法(BDPT)、ReSTIR、VCM算法等（光子映射类算法不得分）
  - 体积光

- 中

  - 位移贴图
  - 景深
  - 运动模糊
  - 色散

- 低

  - 更复杂的采样方法：cos-weighted采样，BRDF采样，MIS等
  - 抗锯齿
  - 纹理贴图
  - 凹凸贴图
  - 法线贴图
  - 法向插值

此外还有构图分数等主观分数，GPU 加速也有加分。上面没有列出的额外效果只要实现并写明原理也会加分。如果实现了某种效果（例如：景深、色散、贴图等），请在最终提交的图片中体现。

最终提交的报告中请在【路径追踪基础实现】的三个得分点中选择一个，作实现前后的效果对比。
例如：
  - 路径追踪的无穷递归和Whitted-Style的仅考虑一次漫反射之间的效果对比；
  - 使用基于BRDF着色前后的效果对比；
  - 使用NEE前后的收敛速度和效果对比；
  - ……
言之成理即可。

注：完成基础要求的第一项后至少 25 分，完成基础要求（包含对比）至少 30 分。

```

## 二. 本仓库的实现
  - 路径追踪要求下的所有内容（路径追踪，path tracing，简称pt，不是whitted style ray tracing）
  - 参数曲面解析法求交（仅限旋转曲面，且有瑕疵）
  - 景深
  - 运动模糊
  - cos-weighted采样（包含在路径追踪中）
  - 抗锯齿（包含在路径追踪中）
  - 纹理贴图

## 三. 对大作业的感受
1. 对我实现的功能点的感受

由于本菜鸡并没有实现其他功能，所以对其他的难度并不知晓。基础功能必做，不评价。

参数曲面求交，作为高加分项，难度确实大，而且直到ddl我都没有解决在与视线平齐的求交问题。

景深较为简单，只需要改一个文件，写一个类即可。

运动模糊也较为简单。如果你只写球的运动模糊，只需要在大作业前的代码基础上加一行代码即可（前提是你已经有了

纹理贴图的代码量相比较于分值来说较大。如果只实现球的贴图、平面贴图的话难度不大。**注意：实现曲面贴图的前置条件是实现曲面求交**